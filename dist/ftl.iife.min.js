var ftl=function(t){"use strict";function e(t,r,n,a){var o=Error.call(this,t);return Object.setPrototypeOf&&Object.setPrototypeOf(o,e.prototype),o.expected=r,o.found=n,o.location=a,o.name="SyntaxError",o}function r(t,e,r){return r=r||" ",t.length>e?t:(e-=t.length,t+(r+=r.repeat(e)).slice(0,e))}function n(t,r){var n,a,o,l,u={},c=(r=void 0!==r?r:{}).grammarSource,i={Root:dt},s=dt,h=":",d="?.",f=",",p="true",v="false",m=/^[0-9]/,A=/^[^']/,g=/^[^"]/,C=/^[a-zA-Z$_]/,y=/^[a-zA-Z$_0-9_]/,x=/^[ \t\n\r]/,E=lt("?",!1),T=lt(":",!1),N=lt("?.",!1),F=lt(".",!1),b=ct("subscript"),w=lt("[",!1),H=lt("]",!1),S=ct("methodCall"),R=lt("(",!1),j=lt(",",!1),O=lt(")",!1),_=ct("functionCall"),M=ct("boolean"),L=lt("true",!1),P=lt("false",!1),D=ct("number"),I=ut([["0","9"]],!1,!1),k=ct("string"),W=lt("'",!1),X=ut(["'"],!0,!1),V=lt('"',!1),Z=ut(['"'],!0,!1),$=ct("array"),z=ct("dict"),q=lt("{",!1),U=lt("}",!1),B=ct("function-ref"),J=lt("#",!1),K=ut([["a","z"],["A","Z"],"$","_"],!1,!1),G=ut([["a","z"],["A","Z"],"$","_",["0","9"],"_"],!1,!1),Q=ct("symbol"),Y=ct("whitespaces"),tt=ut([" ","\t","\n","\r"],!1,!1),et=0,rt=[{line:1,column:1}],nt=0,at=[],ot=0;if("startRule"in r){if(!(r.startRule in i))throw new Error("Can't start parsing from rule \""+r.startRule+'".');s=i[r.startRule]}function lt(t,e){return{type:"literal",text:t,ignoreCase:e}}function ut(t,e,r){return{type:"class",parts:t,inverted:e,ignoreCase:r}}function ct(t){return{type:"other",description:t}}function it(e){var r,n=rt[e];if(n)return n;for(r=e-1;!rt[r];)r--;for(n={line:(n=rt[r]).line,column:n.column};r<e;)10===t.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return rt[e]=n,n}function st(t,e){var r=it(t),n=it(e);return{source:c,start:{offset:t,line:r.line,column:r.column},end:{offset:e,line:n.line,column:n.column}}}function ht(t){et<nt||(et>nt&&(nt=et,at=[]),at.push(t))}function dt(){var t,e;return t=et,xt(),(e=ft())!==u?(xt(),t=e):(et=t,t=u),t}function ft(){var e,r,n,a,o,l,c;if(e=et,r=function(){var e;e=function(){var e,r,n,a,o,l,c,i;if(ot++,e=et,r=function(){var e,r,n,a,o,l;ot++,e=et,35===t.charCodeAt(et)?(r="#",et++):(r=u,0===ot&&ht(J));if(r!==u){if(n=[],a=et,o=[],C.test(t.charAt(et))?(l=t.charAt(et),et++):(l=u,0===ot&&ht(K)),l!==u)for(;l!==u;)o.push(l),C.test(t.charAt(et))?(l=t.charAt(et),et++):(l=u,0===ot&&ht(K));else o=u;for(o!==u?(58===t.charCodeAt(et)?(l=h,et++):(l=u,0===ot&&ht(T)),l!==u?a=o:(et=a,a=u)):(et=a,a=u);a!==u;){if(n.push(a),a=et,o=[],C.test(t.charAt(et))?(l=t.charAt(et),et++):(l=u,0===ot&&ht(K)),l!==u)for(;l!==u;)o.push(l),C.test(t.charAt(et))?(l=t.charAt(et),et++):(l=u,0===ot&&ht(K));else o=u;o!==u?(58===t.charCodeAt(et)?(l=h,et++):(l=u,0===ot&&ht(T)),l!==u?a=o:(et=a,a=u)):(et=a,a=u)}if(C.test(t.charAt(et))?(a=t.charAt(et),et++):(a=u,0===ot&&ht(K)),a!==u){for(o=[],y.test(t.charAt(et))?(l=t.charAt(et),et++):(l=u,0===ot&&ht(G));l!==u;)o.push(l),y.test(t.charAt(et))?(l=t.charAt(et),et++):(l=u,0===ot&&ht(G));c=a,i=o,e={type:"function",module:n.map((t=>t.join(""))),value:c+i.join("")}}else et=e,e=u}else et=e,e=u;var c,i;ot--,e===u&&(r=u,0===ot&&ht(B));return e}(),r!==u)if(40===t.charCodeAt(et)?(n="(",et++):(n=u,0===ot&&ht(R)),n!==u){for(xt(),a=et,(o=ft())!==u?(l=xt(),a=o):(et=a,a=u),a===u&&(a=null),o=[],l=et,44===t.charCodeAt(et)?(c=f,et++):(c=u,0===ot&&ht(j)),c!==u?(xt(),(i=ft())!==u?(xt(),l=i):(et=l,l=u)):(et=l,l=u);l!==u;)o.push(l),l=et,44===t.charCodeAt(et)?(c=f,et++):(c=u,0===ot&&ht(j)),c!==u?(xt(),(i=ft())!==u?(xt(),l=i):(et=l,l=u)):(et=l,l=u);41===t.charCodeAt(et)?(l=")",et++):(l=u,0===ot&&ht(O)),l!==u?(d=o,e={type:"call",value:r,args:null==(s=a)?[]:[s].concat(d)}):(et=e,e=u)}else et=e,e=u;else et=e,e=u;var s,d;ot--,e===u&&(r=u,0===ot&&ht(_));return e}(),e===u&&(e=function(){var e;e=function(){var e,r,n,a,o,l;ot++,e=et,r=[],m.test(t.charAt(et))?(n=t.charAt(et),et++):(n=u,0===ot&&ht(I));if(n!==u)for(;n!==u;)r.push(n),m.test(t.charAt(et))?(n=t.charAt(et),et++):(n=u,0===ot&&ht(I));else r=u;if(r!==u){if(n=et,46===t.charCodeAt(et)?(a=".",et++):(a=u,0===ot&&ht(F)),a!==u){for(o=[],m.test(t.charAt(et))?(l=t.charAt(et),et++):(l=u,0===ot&&ht(I));l!==u;)o.push(l),m.test(t.charAt(et))?(l=t.charAt(et),et++):(l=u,0===ot&&ht(I));n=o}else et=n,n=u;n===u&&(n=null),c=r,e=null==(i=n)?{type:"literal",value:parseInt(c.join(""))}:{type:"literal",value:parseFloat(c.join("")+"."+i.join(""))}}else et=e,e=u;var c,i;ot--,e===u&&(r=u,0===ot&&ht(D));return e}(),e===u&&(e=function(){var e,r;ot++,e=et,t.substr(et,4)===p?(r=p,et+=4):(r=u,0===ot&&ht(L));r!==u&&(r={type:"literal",value:!0});(e=r)===u&&(e=et,t.substr(et,5)===v?(r=v,et+=5):(r=u,0===ot&&ht(P)),r!==u&&(r={type:"literal",value:!1}),e=r);ot--,e===u&&(r=u,0===ot&&ht(M));return e}(),e===u&&(e=Ct())===u&&(e=function(){var e,r,n,a,o,l,c;ot++,e=et,91===t.charCodeAt(et)?(r="[",et++):(r=u,0===ot&&ht(w));if(r!==u){for(xt(),(n=ft())===u&&(n=null),xt(),a=[],o=et,44===t.charCodeAt(et)?(l=f,et++):(l=u,0===ot&&ht(j)),l!==u?(xt(),(c=ft())!==u?(xt(),o=c):(et=o,o=u)):(et=o,o=u);o!==u;)a.push(o),o=et,44===t.charCodeAt(et)?(l=f,et++):(l=u,0===ot&&ht(j)),l!==u?(xt(),(c=ft())!==u?(xt(),o=c):(et=o,o=u)):(et=o,o=u);93===t.charCodeAt(et)?(o="]",et++):(o=u,0===ot&&ht(H)),o!==u?(s=a,e={type:"array",value:null==(i=n)?[]:[i].concat(s)}):(et=e,e=u)}else et=e,e=u;var i,s;ot--,e===u&&(r=u,0===ot&&ht($));return e}(),e===u&&(e=function(){var e,r,n,a,o,l,c,i,s,d,p;ot++,e=et,123===t.charCodeAt(et)?(r="{",et++):(r=u,0===ot&&ht(q));if(r!==u){for(xt(),n=et,(a=Ct())!==u?(o=xt(),58===t.charCodeAt(et)?(l=h,et++):(l=u,0===ot&&ht(T)),l!==u?(c=xt(),(i=ft())!==u?n=[a,i]:(et=n,n=u)):(et=n,n=u)):(et=n,n=u),n===u&&(n=null),a=xt(),o=[],l=et,44===t.charCodeAt(et)?(c=f,et++):(c=u,0===ot&&ht(j)),c!==u?(i=xt(),(s=Ct())!==u?(xt(),58===t.charCodeAt(et)?(d=h,et++):(d=u,0===ot&&ht(T)),d!==u?(xt(),(p=ft())!==u?(xt(),l=[s,p]):(et=l,l=u)):(et=l,l=u)):(et=l,l=u)):(et=l,l=u);l!==u;)o.push(l),l=et,44===t.charCodeAt(et)?(c=f,et++):(c=u,0===ot&&ht(j)),c!==u?(i=xt(),(s=Ct())!==u?(xt(),58===t.charCodeAt(et)?(d=h,et++):(d=u,0===ot&&ht(T)),d!==u?(xt(),(p=ft())!==u?(xt(),l=[s,p]):(et=l,l=u)):(et=l,l=u)):(et=l,l=u)):(et=l,l=u);125===t.charCodeAt(et)?(l="}",et++):(l=u,0===ot&&ht(U)),l!==u?(m=o,A=[],null!==(v=n)&&A.push(v),A.push.apply(A,m),e={type:"dict",value:A}):(et=e,e=u)}else et=e,e=u;var v,m,A;ot--,e===u&&(r=u,0===ot&&ht(z));return e}(),e===u&&(e=Ct()))));return e}(),e===u&&(e=yt()));return e}(),r!==u){for(xt(),n=[],a=et,(o=pt())===u&&(o=vt())===u&&(o=mt())===u&&(o=At())===u&&(o=gt()),o!==u?(xt(),a=o):(et=a,a=u);a!==u;)n.push(a),a=et,(o=pt())===u&&(o=vt())===u&&(o=mt())===u&&(o=At())===u&&(o=gt()),o!==u?(xt(),a=o):(et=a,a=u);l=r,e=0===(c=n).length?l:{type:"nav",from:l,to:c}}else et=e,e=u;return e}function pt(){var e,r,n,a,o;return e=et,63===t.charCodeAt(et)?(r="?",et++):(r=u,0===ot&&ht(E)),r!==u?(xt(),(n=ft())===u&&(n=null),xt(),58===t.charCodeAt(et)?(a=h,et++):(a=u,0===ot&&ht(T)),a!==u?(xt(),(o=ft())!==u?e={type:"cond",ifTrue:n,ifFalse:o}:(et=e,e=u)):(et=e,e=u)):(et=e,e=u),e}function vt(){var e,r,n;return e=et,t.substr(et,2)===d?(r=d,et+=2):(r=u,0===ot&&ht(N)),r!==u?(xt(),(n=yt())!==u?e={type:"dot",ns:!0,value:n.value}:(et=e,e=u)):(et=e,e=u),e}function mt(){var e,r,n;return e=et,46===t.charCodeAt(et)?(r=".",et++):(r=u,0===ot&&ht(F)),r!==u?(xt(),(n=yt())!==u?e={type:"dot",ns:!1,value:n.value}:(et=e,e=u)):(et=e,e=u),e}function At(){var e,r,n,a,o;return ot++,e=et,t.substr(et,2)===d?(r=d,et+=2):(r=u,0===ot&&ht(N)),r===u&&(r=null),91===t.charCodeAt(et)?(n="[",et++):(n=u,0===ot&&ht(w)),n!==u?(xt(),(a=ft())!==u?(xt(),93===t.charCodeAt(et)?(o="]",et++):(o=u,0===ot&&ht(H)),o!==u?e={type:"sub",ns:null!==r,value:a}:(et=e,e=u)):(et=e,e=u)):(et=e,e=u),ot--,e===u&&(r=u,0===ot&&ht(b)),e}function gt(){var e,r,n,a,o,l,c,i,s,h;if(ot++,e=et,t.substr(et,2)===d?(r=d,et+=2):(r=u,0===ot&&ht(N)),r===u&&(r=null),40===t.charCodeAt(et)?(n="(",et++):(n=u,0===ot&&ht(R)),n!==u){for(xt(),a=et,(o=ft())!==u?(l=xt(),a=o):(et=a,a=u),a===u&&(a=null),o=[],l=et,44===t.charCodeAt(et)?(c=f,et++):(c=u,0===ot&&ht(j)),c!==u?(xt(),(i=ft())!==u?(xt(),l=i):(et=l,l=u)):(et=l,l=u);l!==u;)o.push(l),l=et,44===t.charCodeAt(et)?(c=f,et++):(c=u,0===ot&&ht(j)),c!==u?(xt(),(i=ft())!==u?(xt(),l=i):(et=l,l=u)):(et=l,l=u);41===t.charCodeAt(et)?(l=")",et++):(l=u,0===ot&&ht(O)),l!==u?(h=o,e={type:"method",ns:null!==r,value:null==(s=a)?[]:[s].concat(h)}):(et=e,e=u)}else et=e,e=u;return ot--,e===u&&(r=u,0===ot&&ht(S)),e}function Ct(){var e,r,n,a;if(ot++,e=et,39===t.charCodeAt(et)?(r="'",et++):(r=u,0===ot&&ht(W)),r!==u){for(n=[],A.test(t.charAt(et))?(a=t.charAt(et),et++):(a=u,0===ot&&ht(X));a!==u;)n.push(a),A.test(t.charAt(et))?(a=t.charAt(et),et++):(a=u,0===ot&&ht(X));39===t.charCodeAt(et)?(a="'",et++):(a=u,0===ot&&ht(W)),a!==u?e=function(t){return{type:"literal",value:t.join("")}}(n):(et=e,e=u)}else et=e,e=u;if(e===u)if(e=et,34===t.charCodeAt(et)?(r='"',et++):(r=u,0===ot&&ht(V)),r!==u){for(n=[],g.test(t.charAt(et))?(a=t.charAt(et),et++):(a=u,0===ot&&ht(Z));a!==u;)n.push(a),g.test(t.charAt(et))?(a=t.charAt(et),et++):(a=u,0===ot&&ht(Z));34===t.charCodeAt(et)?(a='"',et++):(a=u,0===ot&&ht(V)),a!==u?e={type:"literal",value:v1.join("")}:(et=e,e=u)}else et=e,e=u;return ot--,e===u&&(r=u,0===ot&&ht(k)),e}function yt(){var e,r,n,a;if(ot++,e=et,C.test(t.charAt(et))?(r=t.charAt(et),et++):(r=u,0===ot&&ht(K)),r!==u){for(n=[],y.test(t.charAt(et))?(a=t.charAt(et),et++):(a=u,0===ot&&ht(G));a!==u;)n.push(a),y.test(t.charAt(et))?(a=t.charAt(et),et++):(a=u,0===ot&&ht(G));e={type:"symbol",value:r+n.join("")}}else et=e,e=u;return ot--,e===u&&(r=u,0===ot&&ht(Q)),e}function xt(){var e,r;for(ot++,e=[],x.test(t.charAt(et))?(r=t.charAt(et),et++):(r=u,0===ot&&ht(tt));r!==u;)e.push(r),x.test(t.charAt(et))?(r=t.charAt(et),et++):(r=u,0===ot&&ht(tt));return ot--,r=u,0===ot&&ht(Y),e}if((n=s())!==u&&et===t.length)return n;throw n!==u&&et<t.length&&ht({type:"end"}),a=at,o=nt<t.length?t.charAt(nt):null,l=nt<t.length?st(nt,nt+1):st(nt,nt),new e(e.buildMessage(a,o),a,o,l)}function a(t,e,r,n){var o=Error.call(this,t);return Object.setPrototypeOf&&Object.setPrototypeOf(o,a.prototype),o.expected=e,o.found=r,o.location=n,o.name="SyntaxError",o}function o(t,e,r){return r=r||" ",t.length>e?t:(e-=t.length,t+(r+=r.repeat(e)).slice(0,e))}function l(t,e){var r,n,o,l,u={},c=(e=void 0!==e?e:{}).grammarSource,i={Root:L},s=L,h="{{{",d="}}}",f="{{",p="}}",v="{",m="}",A=/^[^{}]/,g=j("{{{",!1),C=j("}}}",!1),y=j("{{",!1),x=j("}}",!1),E={type:"class",parts:["{","}"],inverted:!0,ignoreCase:!1},T=j("{",!1),N=j("}",!1),F=j("\\",!1),b=0,w=[{line:1,column:1}],H=0,S=[],R=0;if("startRule"in e){if(!(e.startRule in i))throw new Error("Can't start parsing from rule \""+e.startRule+'".');s=i[e.startRule]}function j(t,e){return{type:"literal",text:t,ignoreCase:e}}function O(e){var r,n=w[e];if(n)return n;for(r=e-1;!w[r];)r--;for(n={line:(n=w[r]).line,column:n.column};r<e;)10===t.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return w[e]=n,n}function _(t,e){var r=O(t),n=O(e);return{source:c,start:{offset:t,line:r.line,column:r.column},end:{offset:e,line:n.line,column:n.column}}}function M(t){b<H||(b>H&&(H=b,S=[]),S.push(t))}function L(){var t,e;for(t=[],e=P();e!==u;)t.push(e),e=P();return t}function P(){var e,r,n,a,o;return e=b,r=b,n=function(){var e;t.substr(b,3)===h?(e=h,b+=3):(e=u,0===R&&M(g));return e}(),n!==u&&(a=D())!==u?(o=function(){var e;t.substr(b,3)===d?(e=d,b+=3):(e=u,0===R&&M(C));return e}(),o!==u?r=a:(b=r,r=u)):(b=r,r=u),r!==u&&(r={t:"he",v:r}),(e=r)===u&&(e=b,r=b,n=function(){var e;t.substr(b,2)===f?(e=f,b+=2):(e=u,0===R&&M(y));return e}(),n!==u&&(a=D())!==u?(o=function(){var e;t.substr(b,2)===p?(e=p,b+=2):(e=u,0===R&&M(x));return e}(),o!==u?r=a:(b=r,r=u)):(b=r,r=u),r!==u&&(r=function(t){return{t:"te",v:t}}(r)),(e=r)===u&&(e=b,(r=D())!==u&&(r=function(t){return{t:"t",v:t}}(r)),e=r)),e}function D(){var e,r,n,a,o;if(b,e=[],(r=I())===u&&(r=k())===u&&(r=b,A.test(t.charAt(b))?(n=t.charAt(b),b++):(n=u,0===R&&M(E)),n!==u?r=n:(b=r,r=u),r===u&&(r=b,123===t.charCodeAt(b)?(n=v,b++):(n=u,0===R&&M(T)),n!==u?(a=b,R++,123===t.charCodeAt(b)?(o=v,b++):(o=u,0===R&&M(T)),R--,o===u?a=void 0:(b=a,a=u),a!==u?r=n:(b=r,r=u)):(b=r,r=u),r===u&&(r=b,125===t.charCodeAt(b)?(n=m,b++):(n=u,0===R&&M(N)),n!==u?(a=b,R++,125===t.charCodeAt(b)?(o=m,b++):(o=u,0===R&&M(N)),R--,o===u?a=void 0:(b=a,a=u),a!==u?r=n:(b=r,r=u)):(b=r,r=u)))),r!==u)for(;r!==u;)e.push(r),(r=I())===u&&(r=k())===u&&(r=b,A.test(t.charAt(b))?(n=t.charAt(b),b++):(n=u,0===R&&M(E)),n!==u?r=n:(b=r,r=u),r===u&&(r=b,123===t.charCodeAt(b)?(n=v,b++):(n=u,0===R&&M(T)),n!==u?(a=b,R++,123===t.charCodeAt(b)?(o=v,b++):(o=u,0===R&&M(T)),R--,o===u?a=void 0:(b=a,a=u),a!==u?r=n:(b=r,r=u)):(b=r,r=u),r===u&&(r=b,125===t.charCodeAt(b)?(n=m,b++):(n=u,0===R&&M(N)),n!==u?(a=b,R++,125===t.charCodeAt(b)?(o=m,b++):(o=u,0===R&&M(N)),R--,o===u?a=void 0:(b=a,a=u),a!==u?r=n:(b=r,r=u)):(b=r,r=u))));else e=u;return e!==u&&(e=e.join("")),e}function I(){var e,r,n;return e=b,92===t.charCodeAt(b)?(r="\\",b++):(r=u,0===R&&M(F)),r!==u?(123===t.charCodeAt(b)?(n=v,b++):(n=u,0===R&&M(T)),n!==u?e=n:(b=e,e=u)):(b=e,e=u),e}function k(){var e,r,n;return e=b,92===t.charCodeAt(b)?(r="\\",b++):(r=u,0===R&&M(F)),r!==u?(125===t.charCodeAt(b)?(n=m,b++):(n=u,0===R&&M(N)),n!==u?e=n:(b=e,e=u)):(b=e,e=u),e}if((r=s())!==u&&b===t.length)return r;throw r!==u&&b<t.length&&M({type:"end"}),n=S,o=H<t.length?t.charAt(H):null,l=H<t.length?_(H,H+1):_(H,H),new a(a.buildMessage(n,o),n,o,l)}!function(t,e){function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r}(e,Error),e.prototype.format=function(t){var e="Error: "+this.message;if(this.location){var n,a=null;for(n=0;n<t.length;n++)if(t[n].source===this.location.source){a=t[n].text.split(/\r\n|\n|\r/g);break}var o=this.location.start,l=this.location.source+":"+o.line+":"+o.column;if(a){var u=this.location.end,c=r("",o.line.toString().length," "),i=a[o.line-1],s=(o.line===u.line?u.column:i.length+1)-o.column||1;e+="\n --\x3e "+l+"\n"+c+" |\n"+o.line+" | "+i+"\n"+c+" | "+r("",o.column-1," ")+r("",s,"^")}else e+="\n at "+l}return e},e.buildMessage=function(t,e){var r={literal:function(t){return'"'+a(t.text)+'"'},class:function(t){var e=t.parts.map((function(t){return Array.isArray(t)?o(t[0])+"-"+o(t[1]):o(t)}));return"["+(t.inverted?"^":"")+e.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(t){return t.description}};function n(t){return t.charCodeAt(0).toString(16).toUpperCase()}function a(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+n(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+n(t)}))}function o(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+n(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+n(t)}))}function l(t){return r[t.type](t)}return"Expected "+function(t){var e,r,n=t.map(l);if(n.sort(),n.length>0){for(e=1,r=1;e<n.length;e++)n[e-1]!==n[e]&&(n[r]=n[e],r++);n.length=r}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}(t)+" but "+function(t){return t?'"'+a(t)+'"':"end of input"}(e)+" found."},function(t,e){function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r}(a,Error),a.prototype.format=function(t){var e="Error: "+this.message;if(this.location){var r,n=null;for(r=0;r<t.length;r++)if(t[r].source===this.location.source){n=t[r].text.split(/\r\n|\n|\r/g);break}var a=this.location.start,l=this.location.source+":"+a.line+":"+a.column;if(n){var u=this.location.end,c=o("",a.line.toString().length," "),i=n[a.line-1],s=(a.line===u.line?u.column:i.length+1)-a.column||1;e+="\n --\x3e "+l+"\n"+c+" |\n"+a.line+" | "+i+"\n"+c+" | "+o("",a.column-1," ")+o("",s,"^")}else e+="\n at "+l}return e},a.buildMessage=function(t,e){var r={literal:function(t){return'"'+a(t.text)+'"'},class:function(t){var e=t.parts.map((function(t){return Array.isArray(t)?o(t[0])+"-"+o(t[1]):o(t)}));return"["+(t.inverted?"^":"")+e.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(t){return t.description}};function n(t){return t.charCodeAt(0).toString(16).toUpperCase()}function a(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+n(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+n(t)}))}function o(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+n(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+n(t)}))}function l(t){return r[t.type](t)}return"Expected "+function(t){var e,r,n=t.map(l);if(n.sort(),n.length>0){for(e=1,r=1;e<n.length;e++)n[e-1]!==n[e]&&(n[r]=n[e],r++);n.length=r}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}(t)+" but "+function(t){return t?'"'+a(t)+'"':"end of input"}(e)+" found."};class u{constructor(t,e){this.dataStack=t,this.functions=e}call(t){const e=t.value,r=e.module.reduce(((t,e)=>t[e]),this.functions),n=t.args.map((t=>this.visit(t)));return r[e.value].apply(this,n)}nav(t){const e=[this.visit(t.from)];for(let r=0;r!==t.to.length;++r){const n=this.visit(t.to[r],e[r],e[r-1]);if(0===n.length)return e[e.length-1];e.push(n[0])}return e[e.length-1]}literal(t){return t.value}symbol(t){if("self"===t.value)return this.dataStack[this.dataStack.length-1];for(let e=this.dataStack.length;0!==e;--e){const r=this.dataStack[e-1];if(r.hasOwnProperty(t.value))return r[t.value]}}dict(t){return t.value.map((t=>[t[0].value,this.visit(t[1])]))}array(t){return t.value.map((t=>this.visit(t)))}cond(t,e){return[e?null===t.ifTrue?e:this.visit(t.ifTrue):this.visit(t.ifFalse)]}dot(t,e){return t.ns&&null==e?[]:[e[t.value]]}sub(t,e){return t.ns&&null==e?[]:[e[this.visit(t.value)]]}method(t,e,r){if(t.ns&&null==e)return[];const n=t.value.map((t=>this.visit(t)));return[e.apply(r,n)]}visit(t,...e){return this[t.type](t,...e)}}const c={fragmentFromNodes(t,e,...r){const n=new DocumentFragment;for(let a=0;a!==r.length;++a){const o=r[a],l=e&&o instanceof HTMLTemplateElement?o.content:o;n.appendChild(t?l.cloneNode(!0):o)}return n},fragmentFromHtml(...t){const e=document.createElement("div");return e.innerHTML=t.join(""),c.fragmentFromNodes(!1,!1,...e.childNodes)},html(...t){var e=document.createElement("root");return e.appendChild(c.fragmentFromNodes(!0,!1,...t)),e.innerHTML},addSuccessors(t,e){const r=Array.from(e);let n=t.nextSibling;for(let e=0;e!==r.length;++e){const a=r[e],o=a instanceof DocumentFragment?a.lastChild:a;t.parentNode.insertBefore(a,n),n=o?.nextSibling}}};class i{constructor(t){this.prefix=t,this.forRemoval=[]}remove(t){"innerHTML"in t&&(t.innerHTML=""),"dataset"in t&&Object.keys(t.dataset).filter((t=>t.startsWith(this.prefix))).forEach((e=>delete t.dataset[e])),this.forRemoval.push(t)}popData(t,e){const r=t.dataset[e];return delete t.dataset[e],r}replace(t,e){c.addSuccessors(t,e),this.remove(t)}cleanup(){for(;this.forRemoval.length;)this.forRemoval.pop().remove()}}class s{static DATA_PREFIX="tpl";static COMMANDS=["tplIf","tplWith","tplEach","tplClassAppend","tplAttrAppend","tplText","tplHtml","tplRemove"];dataPrefix(){return s.DATA_PREFIX}orderedCommands(){return s.COMMANDS}tplIf(t,e,r,n,...a){t.evaluator.evaluate(r,...a)||n.remove(e)}tplWith(t,e,r,n,...a){const o=t.evaluator.evaluate(r,...a),l=n.popData(e,s.DATA_PREFIX+"Var"),u=t.withNode(e).render(...a,l?{[l]:o}:o);n.replace(e,[u])}tplEach(t,e,r,n,...a){const o=n.popData(e,s.DATA_PREFIX+"Var"),l=t.evaluator.evaluate(r,...a).map((r=>t.withNode(e).render(...a,o?{[o]:r}:r)));n.replace(e,l)}tplRemove(t,e,r,n,...a){switch(r.toLowerCase()){case"tag":n.replace(e,e.childNodes);break;case"body":e.innerHTML="";break;case"all":n.remove(e)}}tplText(t,e,r,n,...a){const o=t.evaluator.evaluate(r,...a);e.innerHTML="",e.textContent=o}tplHtml(t,e,r,n,...a){const o=t.evaluator.evaluate(r,...a);e.innerHTML=o}tplClassAppend(t,e,r,n,...a){const o=t.evaluator.evaluate(r,...a),l=Array.isArray(o)?o:[o];e.classList.add(...l)}tplAttrAppend(t,e,r,n,...a){const o=t.evaluator.evaluate(r,...a);if(0===o.length)return;(Array.isArray(o[0])?o:[o]).forEach((([t,r])=>{e.setAttribute(t,r)}))}textNode(t,e,r,n,...a){const o=t.textNodeEvaluator.evaluate(r,...a).map((t=>"t"===t.t?document.createTextNode(t.v):c.fragmentFromHtml(t.v)));n.replace(e,o)}}class h{fragment;evaluator;textNodeEvaluator;commandsHandler;static fromHtml(t,e,r,n){return new h({fragment:c.fragmentFromHtml(t),evaluator:e,textNodeEvaluator:r,commandsHandler:n})}static fromNodes(t,e,r,n){return new h({fragment:c.fragmentFromNodes(!0,!1,...t),evaluator:e,textNodeEvaluator:r,commandsHandler:n})}static fromNode(t,e,r,n){return new h({fragment:c.fragmentFromNodes(!0,!0,t),evaluator:e,textNodeEvaluator:r,commandsHandler:n})}static fromSelector(t,e,r,n){const a=document.querySelector(t);return new h({fragment:c.fragmentFromNodes(!0,!0,a),evaluator:e,textNodeEvaluator:r,commandsHandler:n})}static render(t,...e){return new h(t).render(...e)}static renderTo(t,e,...r){return new h(t).renderTo(e,...r)}static renderToSelector(t,e,...r){return new h(t).renderToSelector(e,...r)}static appendTo(t,e,...r){return new h(t).appendTo(e,...r)}static appendToSelector(t,e,...r){return new h(t).appendToSelector(e,...r)}constructor({fragment:t,evaluator:e,textNodeEvaluator:r,commandsHandler:n}){this.fragment=t,this.evaluator=e,this.textNodeEvaluator=r,this.commandsHandler=n||new s}withNode(t){return h.fromNode(t,this.evaluator,this.textNodeEvaluator,this.commandsHandler)}render(...t){const e=this.commandsHandler.dataPrefix(),r=new i(e),n=this.fragment.cloneNode(!0),a=function(t,e,r){const n=`data-${t}-`;return function(t){return t.nodeType===Node.TEXT_NODE?-1!==t.nodeValue.indexOf(e)&&-1!==t.nodeValue.indexOf(r)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT:Array.from(t.attributes).some((t=>t.name.startsWith(n)))?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}}(e,"{{","}}"),o=document.createNodeIterator(n,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT,a);let l;for(;null!==(l=o.nextNode());){if(r.cleanup(),l.nodeType===Node.TEXT_NODE){this.commandsHandler.textNode(this,l,l.nodeValue,r,...t);continue}const e=this.commandsHandler.orderedCommands();for(let n=0;n!==e.length;++n){const a=e[n];if(!(a in l.dataset))continue;const o=r.popData(l,a);this.commandsHandler[a](this,l,o,r,...t)}Object.keys(l.dataset).filter((t=>t.startsWith(this.commandsHandler.dataPrefix()))).map((t=>[t,t.substring(this.commandsHandler.dataPrefix().length).split(/(?=[A-Z])/).join("-").toLowerCase()])).forEach((([e,n])=>{const a=r.popData(l,e),o=this.evaluator.evaluate(a,...t);l.setAttribute(n,o)}))}return r.cleanup(),n}renderTo(t,...e){const r=this.render(...e);t.innerHTML="",t.appendChild(r)}renderToSelector(t,...e){const r=document.querySelector(t);this.renderTo(r,...e)}appendTo(t,...e){const r=this.render(...e);t.appendChild(r)}appendToSelector(t,...e){const r=document.querySelector(t);this.appendTo(r,...e)}}return t.ExpressionEvaluator=class{constructor(t){this.functions=t||{}}parse(t){return n(t)}evaluateAst(t,e){return new u(e,this.functions).visit(t)}evaluate(t,...e){return this.evaluateAst(this.parse(t),e)}},t.Template=h,t.TextNodeExpressionEvaluator=class{constructor(t){this.evaluator=t}parse(t){return l(t).map((t=>"t"===t.t?t:{t:t.t,v:this.evaluator.parse(t.v)}))}evaluateAst(t,e){return t.map((t=>"t"===t.t?t:{t:"te"===t.t?"t":"h",v:this.evaluator.evaluateAst(t.v,e)}))}evaluate(t,...e){return this.evaluateAst(this.parse(t),e)}},t.TplCommandsHandler=s,Object.defineProperty(t,"__esModule",{value:!0}),t}({});
//# sourceMappingURL=ftl.iife.min.js.map
